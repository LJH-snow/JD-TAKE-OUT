# 📊 JD外卖系统数据库设计文档

**文档目标**: 详细阐述JD外卖项目的数据库表结构，包括每个表的用途和每个字段的含义，并提供由AI生成的注释。

**最后更新**: 2025年9月11日

---

## 核心设计理念

本数据库设计旨在支持JD外卖系统的核心业务流程，包括用户管理、商品管理、订单管理、店铺设置以及数据统计分析。设计遵循以下原则：

*   **数据完整性**: 确保关键业务数据的准确性和一致性。
*   **可扩展性**: 考虑未来业务增长和功能扩展的需求。
*   **性能优化**: 通过合理的索引和视图设计，提高数据查询效率。
*   **软删除/状态标记**: 针对不同业务场景，采用软删除或状态标记来保留历史数据，支持统计分析。

---

## 数据库表结构详情

### 1. `address_books` (地址簿)

**用途**: 存储用户的收货地址信息，支持高德地图相关地理位置数据。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('address_books_id_seq'::regclass)` | 主键，地址簿唯一标识符。 |
| `user_id` | `bigint` | NO | | 关联到 `users` 表的用户ID，表示该地址属于哪个用户。 |
| `consignee` | `character varying` | YES | | 收货人姓名。 |
| `sex` | `character varying` | YES | | 收货人性别（例如：'1'代表男，'0'代表女）。 |
| `phone` | `character varying` | NO | | 收货人联系电话。 |
| `province_code` | `character varying` | YES | | 省级行政区划代码。 |
| `province_name` | `character varying` | YES | | 省级行政区划名称。 |
| `city_code` | `character varying` | YES | | 市级行政区划代码。 |
| `city_name` | `character varying` | YES | | 市级行政区划名称。 |
| `district_code` | `character varying` | YES | | 区级行政区划代码。 |
| `district_name` | `character varying` | YES | | 区级行政区划名称。 |
| `detail` | `character varying` | YES | | 详细地址，如街道、门牌号。 |
| `label` | `character varying` | YES | | 地址标签，如“家”、“公司”。 |
| `is_default` | `integer` | YES | `0` | 是否为默认地址（0: 否, 1: 是）。 |
| `longitude` | `numeric` | YES | | 经度信息，用于地图定位。 |
| `latitude` | `numeric` | YES | | 纬度信息，用于地图定位。 |
| `formatted_address` | `character varying` | YES | | 格式化后的完整地址字符串。 |
| `created_at` | `timestamp with time zone` | YES | | 记录创建时间。 |
| `updated_at` | `timestamp with time zone` | YES | | 记录最后更新时间。 |
| `deleted_at` | `timestamp with time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |

### 2. `categories` (分类)

**用途**: 存储菜品和套餐的分类信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('categories_id_seq'::regclass)` | 主键，分类唯一标识符。 |
| `type` | `bigint` | YES | | 分类类型（1: 菜品分类, 2: 套餐分类）。 |
| `name` | `character varying` | NO | | 分类名称，唯一。 |
| `sort` | `integer` | NO | `0` | 排序权重，数字越小越靠前。 |
| `status` | `integer` | YES | `1` | 分类状态（0: 禁用, 1: 启用）。 |
| `image` | `character varying` | YES | | 分类图片URL。 |
| `created_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录创建时间。 |
| `updated_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录最后更新时间。 |
| `create_user` | `bigint` | YES | | 创建该分类的用户ID（通常是管理员）。 |
| `update_user` | `bigint` | YES | | 最后更新该分类的用户ID。 |
| `deleted_at` | `timestamp without time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |

### 3. `category_sales_stats` (分类销售统计视图)

**用途**: 这是一个视图，用于聚合和展示菜品分类的销售统计数据，便于报表和图表展示。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | YES | | 分类ID。 |
| `category_name` | `character varying` | YES | | 分类名称。 |
| `dish_count` | `bigint` | YES | | 该分类下的菜品数量。 |
| `total_quantity` | `bigint` | YES | | 该分类下所有菜品的总销量。 |
| `total_revenue` | `numeric` | YES | | 该分类下所有菜品的总销售额。 |

### 4. `daily_sales_stats` (每日销售统计视图)

**用途**: 这是一个视图，用于聚合和展示每日的销售数据，包括订单数量、总销售额和平均订单金额，便于销售趋势分析。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `sale_date` | `date` | YES | | 销售日期。 |
| `order_count` | `bigint` | YES | | 当日的订单总数。 |
| `total_amount` | `numeric` | YES | | 当日的总销售额。 |
| `avg_amount` | `numeric` | YES | | 当日的平均订单金额。 |

### 5. `dish_flavors` (菜品口味)

**用途**: 存储菜品的口味选项，如辣度、甜度等。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('dish_flavors_id_seq'::regclass)` | 主键，口味选项唯一标识符。 |
| `dish_id` | `bigint` | NO | | 关联到 `dishes` 表的菜品ID，表示该口味属于哪个菜品。 |
| `name` | `character varying` | YES | | 口味名称，如“辣度”、“甜度”。 |
| `value` | `character varying` | YES | | 口味值列表，通常以JSON字符串形式存储，如 `["不辣","微辣"]`。 |

### 6. `dish_sales_stats` (菜品销售统计视图)

**用途**: 这是一个视图，用于聚合和展示单个菜品的销售统计数据，包括销量和销售额，便于热销菜品排行。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | YES | | 菜品ID。 |
| `name` | `character varying` | YES | | 菜品名称。 |
| `price` | `numeric` | YES | | 菜品单价。 |
| `category_name` | `character varying` | YES | | 所属分类名称。 |
| `total_sales` | `bigint` | YES | | 菜品的总销量。 |
| `total_revenue` | `numeric` | YES | | 菜品的总销售额。 |

### 7. `dishes` (菜品)

**用途**: 存储具体的菜品信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('dishes_id_seq'::regclass)` | 主键，菜品唯一标识符。 |
| `name` | `character varying` | NO | | 菜品名称，唯一。 |
| `category_id` | `bigint` | NO | | 关联到 `categories` 表的分类ID。 |
| `price` | `numeric` | YES | `0.00` | 菜品价格。 |
| `image` | `character varying` | YES | | 菜品图片URL。 |
| `description` | `character varying` | YES | | 菜品描述信息。 |
| `status` | `integer` | YES | `1` | 售卖状态（0: 停售, 1: 起售）。 |
| `sales_count` | `integer` | YES | `0` | 菜品销量统计。 |
| `created_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录创建时间。 |
| `updated_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录最后更新时间。 |
| `deleted_at` | `timestamp without time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |
| `code` | `character varying` | YES | | 菜品编码，用于内部管理或外部集成。 |
| `create_user` | `bigint` | YES | | 创建该菜品的用户ID（通常是管理员）。 |
| `update_user` | `bigint` | YES | | 最后更新该菜品的用户ID。 |

### 8. `employees` (员工)

**用途**: 存储管理员和员工的账户信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('employees_id_seq'::regclass)` | 主键，员工唯一标识符。 |
| `name` | `character varying` | NO | | 员工姓名。 |
| `username` | `character varying` | NO | | 员工登录用户名，唯一。 |
| `password` | `character varying` | NO | | 员工登录密码（加密存储）。 |
| `phone` | `character varying` | NO | | 员工联系电话。 |
| `sex` | `character varying` | NO | | 员工性别。 |
| `id_number` | `character varying` | NO | | 员工身份证号。 |
| `status` | `bigint` | NO | `1` | 员工账户状态（0: 禁用, 1: 启用）。 |
| `created_at` | `timestamp with time zone` | YES | | 记录创建时间。 |
| `updated_at` | `timestamp with time zone` | YES | | 记录最后更新时间。 |
| `create_user` | `bigint` | YES | | 创建该员工账户的用户ID。 |
| `update_user` | `bigint` | YES | | 最后更新该员工账户的用户ID。 |
| `deleted_at` | `timestamp with time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |

### 9. `order_details` (订单明细)

**用途**: 存储订单中包含的菜品或套餐的具体信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('order_details_id_seq'::regclass)` | 主键，订单明细唯一标识符。 |
| `name` | `character varying` | YES | | 菜品或套餐名称。 |
| `image` | `character varying` | YES | | 菜品或套餐图片URL。 |
| `order_id` | `bigint` | NO | | 关联到 `orders` 表的订单ID。 |
| `dish_id` | `bigint` | YES | | 关联到 `dishes` 表的菜品ID（如果该明细是菜品）。 |
| `setmeal_id` | `bigint` | YES | | 关联到 `setmeals` 表的套餐ID（如果该明细是套餐）。 |
| `dish_flavor` | `character varying` | YES | | 菜品口味描述（如“微辣，不要香菜”）。 |
| `number` | `integer` | NO | `1` | 购买数量。 |
| `amount` | `numeric` | NO | | 该明细的总金额。 |
| `created_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录创建时间。 |
| `updated_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录最后更新时间。 |
| `deleted_at` | `timestamp without time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |

### 10. `orders` (订单)

**用途**: 存储用户的订单信息，包括订单状态、金额、地址等。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('orders_id_seq'::regclass)` | 主键，订单唯一标识符。 |
| `number` | `character varying` | YES | | 订单号，唯一。 |
| `status` | `integer` | NO | `1` | 订单状态（1: 待付款, 2: 待接单, 3: 已接单, 4: 派送中, 5: 已完成, 6: 已取消）。 |
| `user_id` | `bigint` | NO | | 关联到 `users` 表的下单用户ID。 |
| `address_book_id` | `bigint` | NO | | 关联到 `address_books` 表的收货地址ID。 |
| `order_time` | `timestamp without time zone` | NO | `CURRENT_TIMESTAMP` | 下单时间。 |
| `checkout_time` | `timestamp without time zone` | YES | | 结账时间。 |
| `pay_method` | `integer` | NO | `2` | 支付方式（1: 微信, 2: 支付宝）。 |
| `pay_status` | `smallint` | NO | `0` | 支付状态（0: 未支付, 1: 已支付, 2: 退款）。 |
| `amount` | `numeric` | NO | | 订单实收金额。 |
| `remark` | `character varying` | YES | | 订单备注。 |
| `phone` | `character varying` | YES | | 订单联系电话。 |
| `address` | `character varying` | YES | | 订单收货地址。 |
| `user_name` | `character varying` | YES | | 下单用户姓名。 |
| `consignee` | `character varying` | YES | | 收货人姓名。 |
| `delivery_time` | `timestamp without time zone` | YES | | 实际送达时间。 |
| `estimated_delivery_time` | `timestamp without time zone` | YES | | 预计送达时间。 |
| `created_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录创建时间。 |
| `updated_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录最后更新时间。 |
| `cancel_reason` | `character varying` | YES | | 订单取消原因。 |
| `rejection_reason` | `character varying` | YES | | 订单拒绝原因。 |
| `cancel_time` | `timestamp without time zone` | YES | | 订单取消时间。 |
| `delivery_status` | `integer` | NO | `1` | 配送状态（例如：1: 立即送出, 0: 选择具体时间）。 |
| `pack_amount` | `integer` | YES | | 打包费。 |
| `tableware_number` | `integer` | YES | | 餐具数量。 |
| `tableware_status` | `integer` | NO | `1` | 餐具数量状态（例如：1: 按餐量提供, 0: 选择具体数量）。 |
| `deleted_at` | `timestamp without time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |

### 11. `setmeal_dishes` (套餐菜品关系)

**用途**: 存储套餐和其包含的菜品之间的关联关系。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('setmeal_dishes_id_seq'::regclass)` | 主键，套餐菜品关系唯一标识符。 |
| `setmeal_id` | `bigint` | YES | | 关联到 `setmeals` 表的套餐ID。 |
| `dish_id` | `bigint` | YES | | 关联到 `dishes` 表的菜品ID。 |
| `name` | `character varying` | YES | | 菜品名称（冗余字段，方便查询）。 |
| `price` | `numeric` | YES | | 菜品单价（冗余字段）。 |
| `copies` | `integer` | YES | | 菜品在套餐中的份数。 |

### 12. `setmeals` (套餐)

**用途**: 存储套餐商品的信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('setmeals_id_seq'::regclass)` | 主键，套餐唯一标识符。 |
| `category_id` | `bigint` | NO | | 关联到 `categories` 表的分类ID。 |
| `name` | `character varying` | NO | | 套餐名称，唯一。 |
| `price` | `numeric` | NO | | 套餐价格。 |
| `status` | `integer` | YES | `1` | 售卖状态（0: 停售, 1: 起售）。 |
| `description` | `character varying` | YES | | 套餐描述信息。 |
| `image` | `character varying` | YES | | 套餐图片URL。 |
| `sales_count` | `integer` | YES | `0` | 套餐销量统计。 |
| `created_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录创建时间。 |
| `updated_at` | `timestamp without time zone` | YES | `CURRENT_TIMESTAMP` | 记录最后更新时间。 |
| `deleted_at` | `timestamp without time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |
| `create_user` | `bigint` | YES | | 创建该套餐的用户ID（通常是管理员）。 |
| `update_user` | `bigint` | YES | | 最后更新该套餐的用户ID。 |

### 13. `shopping_carts` (购物车)

**用途**: 存储用户的购物车商品信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('shopping_carts_id_seq'::regclass)` | 主键，购物车项唯一标识符。 |
| `name` | `character varying` | YES | | 商品名称（菜品或套餐）。 |
| `image` | `character varying` | YES | | 商品图片URL。 |
| `user_id` | `bigint` | NO | | 关联到 `users` 表的用户ID。 |
| `dish_id` | `bigint` | YES | | 关联到 `dishes` 表的菜品ID（如果购物车项是菜品）。 |
| `setmeal_id` | `bigint` | YES | | 关联到 `setmeals` 表的套餐ID（如果购物车项是套餐）。 |
| `dish_flavor` | `character varying` | YES | | 菜品口味描述。 |
| `number` | `integer` | NO | `1` | 购买数量。 |
| `amount` | `numeric` | NO | | 该购物车项的总金额。 |
| `created_at` | `timestamp without time zone` | YES | | 记录创建时间。 |
| `updated_at` | `timestamp with time zone` | YES | | 记录最后更新时间。 |
| `deleted_at` | `timestamp with time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |

### 14. `store_settings` (店铺设置)

**用途**: 存储店铺的全局配置信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('store_settings_id_seq'::regclass)` | 主键，店铺设置唯一标识符。 |
| `name` | `character varying` | NO | | 店铺名称。 |
| `address` | `character varying` | YES | | 店铺地址。 |
| `phone` | `character varying` | YES | | 店铺联系电话。 |
| `description` | `character varying` | YES | | 店铺描述。 |
| `logo` | `character varying` | YES | | 店铺Logo图片URL。 |
| `created_at` | `timestamp with time zone` | YES | | 记录创建时间。 |
| `updated_at` | `timestamp with time zone` | YES | | 记录最后更新时间。 |
| `create_user` | `bigint` | YES | | 创建该设置的用户ID（通常是管理员）。 |
| `update_user` | `bigint` | YES | | 最后更新该设置的用户ID。 |
| `deleted_at` | `timestamp with time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |
| `is_open` | `boolean` | YES | `true` | 店铺营业状态（`true`: 营业中, `false`: 已打烊）。 |

### 15. `user_consumption_stats` (用户消费统计视图)

**用途**: 这是一个视图，用于聚合和展示用户的消费行为数据，包括订单数量、总消费金额和平均订单金额，便于用户分析。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | YES | | 用户ID。 |
| `name` | `character varying` | YES | | 用户姓名。 |
| `phone` | `character varying` | YES | | 用户手机号。 |
| `order_count` | `bigint` | YES | | 用户的订单总数。 |
| `total_consumption` | `numeric` | YES | | 用户的总消费金额。 |
| `avg_order_amount` | `numeric` | YES | | 用户的平均订单金额。 |
| `last_order_time` | `timestamp without time zone` | YES | | 用户最后一次下单时间。 |

### 16. `users` (用户)

**用途**: 存储普通用户的账户信息。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `id` | `bigint` | NO | `nextval('users_id_seq'::regclass)` | 主键，用户唯一标识符。 |
| `name` | `character varying` | YES | | 用户姓名。 |
| `phone` | `character varying` | YES | | 用户手机号，唯一。 |
| `email` | `character varying` | YES | | 用户邮箱地址。 |
| `password` | `character varying` | YES | | 用户登录密码（加密存储）。 |
| `sex` | `character varying` | YES | | 用户性别。 |
| `avatar` | `character varying` | YES | | 用户头像URL。 |
| `login_type` | `bigint` | YES | `1` | 登录方式（1: 手机号, 2: 邮箱, 3: 微信等）。 |
| `last_login_time` | `timestamp without time zone` | YES | | 最后登录时间。 |
| `is_active` | `boolean` | YES | `true` | 账户是否激活（`true`: 激活, `false`: 禁用）。 |
| `created_at` | `timestamp without time zone` | YES | | 记录创建时间。 |
| `updated_at` | `timestamp without time zone` | YES | | 记录最后更新时间。 |
| `openid` | `character varying` | YES | | 微信OpenID，用于微信登录。 |
| `deleted_at` | `timestamp with time zone` | YES | | 软删除标记，记录删除时间，用于逻辑删除。 |

### 17. `v_category_stats` (分类统计视图)

**用途**: 这是一个视图，用于聚合和展示菜品分类的销售统计数据，包括总销售额、总销量等，便于前端图表展示。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `category_id` | `bigint` | YES | | 分类ID。 |
| `category_name` | `character varying` | YES | | 分类名称。 |
| `category_type` | `bigint` | YES | | 分类类型（1: 菜品分类, 2: 套餐分类）。 |
| `total_revenue` | `numeric` | YES | | 该分类的总销售额。 |
| `total_quantity` | `bigint` | YES | | 该分类下所有商品的销售总量。 |
| `dish_count` | `bigint` | YES | | 该分类下包含的菜品数量。 |
| `order_count` | `bigint` | YES | | 包含该分类商品的订单数量。 |

### 18. `v_daily_sales` (每日销售视图)

**用途**: 这是一个视图，用于聚合和展示每日的销售数据，包括营业额、订单数、顾客数和平均订单金额，便于销售趋势分析。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `date` | `date` | YES | | 销售日期。 |
| `revenue` | `numeric` | YES | | 当日的总销售额。 |
| `orders` | `bigint` | YES | | 当日的订单总数。 |
| `customers` | `bigint` | YES | | 当日的独立顾客数量。 |
| `avg_amount` | `numeric` | YES | | 当日的平均订单金额。 |

### 19. `v_dish_ranking` (菜品排行视图)

**用途**: 这是一个视图，用于聚合和展示菜品的销售排行数据，包括销量、销售额和所属分类，便于热销菜品排行。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `dish_id` | `bigint` | YES | | 菜品ID。 |
| `dish_name` | `character varying` | YES | | 菜品名称。 |
| `category_name` | `character varying` | YES | | 所属分类名称。 |
| `dish_price` | `numeric` | YES | | 菜品单价。 |
| `total_quantity` | `bigint` | YES | | 菜品的总销量。 |
| `total_revenue` | `numeric` | YES | | 菜品的总销售额。 |
| `order_count` | `bigint` | YES | | 包含该菜品的订单数量。 |
| `avg_revenue` | `numeric` | YES | | 包含该菜品的订单平均收入。 |

### 20. `v_monthly_revenue` (月度营收视图)

**用途**: 这是一个视图，用于聚合和展示每月的营收数据，包括总订单数、总营收、平均订单金额和独立顾客数，便于月度报表。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `year` | `numeric` | YES | | 订单年份。 |
| `month` | `numeric` | YES | | 订单月份。 |
| `year_month` | `text` | YES | | 年份-月份字符串（例如 '2025-09'）。 |
| `total_orders` | `bigint` | YES | | 该月的订单总数。 |
| `total_revenue` | `numeric` | YES | | 该月的总营收。 |
| `avg_order_amount` | `numeric` | YES | | 该月的平均订单金额。 |
| `unique_customers` | `bigint` | YES | | 该月的独立顾客数量。 |

### 21. `v_user_activity` (用户活跃度视图)

**用途**: 这是一个视图，用于聚合和展示用户的活跃度数据，包括总订单数、总消费金额、最后下单时间以及活跃状态，便于用户行为分析。

| 字段名 | 数据类型 | 是否可空 | 默认值 | AI生成注释 |
| :--- | :--- | :--- | :--- | :--- |
| `user_id` | `bigint` | YES | | 用户ID。 |
| `user_name` | `character varying` | YES | | 用户姓名。 |
| `user_phone` | `character varying` | YES | | 用户手机号。 |
| `register_date` | `date` | YES | | 用户注册日期。 |
| `total_orders` | `bigint` | YES | | 用户的订单总数。 |
| `total_spent` | `numeric` | YES | | 用户的总消费金额。 |
| `last_order_time` | `timestamp without time zone` | YES | | 用户最后一次下单时间。 |
| `activity_status` | `text` | YES | | 用户活跃状态（例如 'active', 'inactive', 'dormant'）。 |

---

## 总结

这份数据库设计文档详细列出了JD外卖系统当前使用的所有表和视图的结构，并提供了AI生成的注释，旨在帮助您更好地理解数据库的各个组成部分及其在系统中的作用。这些表和视图共同支撑了系统的核心业务逻辑和数据分析功能。

---
